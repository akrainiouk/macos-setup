#!/bin/sh
#
# Used by regssh script. This script is executed by the remote shell
#
ID_RSA_PUB="ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAIEAr+JajbKN0d32csRjKHl/9jDpbaZiKys0wcHjvuu7QJ1bMNgtaNYpieVDKq9YkWeyKhUzhVtatVfkpiRB6QWqx8lXQQkv1ILhOIdtwMnobziUjrlErCcgyPfuaRq/3+XxOpTUCns7bfA7GpTueWkiLrkCbtkgsiRjpCx+hjdBZeM= akrainiouk@woozle"

if ! [ -a ~/.ssh ]
then
    mkdir ~/.ssh
else
    echo .ssh exists
fi

if ! [ -a ~/.ssh/authorized_keys ]
then
    touch ~/.ssh/authorized_keys
else 
    echo ~/.ssh/authorized_keys exists
fi
chmod 700 ~/.ssh
chmod 600 ~/.ssh/authorized_keys

if ( ! grep -q "$ID_RSA_PUB" ~/.ssh/authorized_keys )
then
    echo "$ID_RSA_PUB" >> ~/.ssh/authorized_keys
else
    echo public key is already registered
fi
